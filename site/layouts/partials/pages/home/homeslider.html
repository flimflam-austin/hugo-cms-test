<div class="carousel">
    
    {{ $videoposts := (where .Site.RegularPages "Section" "video_posts").ByDate.Reverse }}
    {{ $featuredvideoposts := where $videoposts ".Params.is_featured" "=" true}}
    {{ $breakingvideoposts := where $videoposts ".Params.is_breaking_slider" "=" true}}
    {{ $sortedvideoposts := union (union $breakingvideoposts $featuredvideoposts) $videoposts }}
    {{ range first 3 (where $sortedvideoposts ".Params.featured_image.url" "!=" nil ) }}
    <section class="carousel-cell {{ if (eq .Params.is_breaking_slider true)}} carousel-cell--breaking {{ end }}">
        {{ if (eq .Params.is_breaking_slider true)}}
        <a class="carousel__link carousel__link--breaking" href="{{- .Permalink -}}">
            <div class="carousel__titlebox">
                <span class="carousel__breaking-tag">Breaking</span>
                <h1 class="carousel__title">{{ .Title }}</h1>
                <p class="carousel__description">{{- .Params.summary -}}</p>
            </div>
        </a>
        {{ else if (eq .Params.is_featured true) }}
        <a class="carousel__link carousel__link--featured" href="{{- .Permalink -}}">
            <div class="carousel__titlebox">
                <h1 class="carousel__title">{{ .Title }}</h1>
                <p class="carousel__description">{{- .Params.summary -}}</p>
            </div>
        </a>
        {{ else }}
        <a class="carousel__link carousel__link--featured" href="{{- .Permalink -}}">
            <div class="carousel__titlebox">
                <h1 class="carousel__title">{{ .Title }}</h1>
                <p class="carousel__description">{{- .Params.summary -}}</p>
            </div>
        </a>
        {{end}}

        {{ $imagePath := .Resources.GetMatch (print .Params.featured_image.url) }}
        {{ $image2000 := $imagePath.Resize "2000x" }}
        {{/*{{ $image300 := $imagePath.Resize "300x"}}
        {{ $image600 := $imagePath.Resize "600x"}}
        {{ $image1200 := $imagePath.Resize "1200x"}}
        {{ $image2000 := $imagePath.Resize "2000x"}}
        <img class="carousel__image"
            srcset="
                {{- $image300.RelPermalink -}} 300w,
                {{- $image600.RelPermalink -}} 600w,
                {{- $image1200.RelPermalink -}} 1200w,
                {{- $image2000.RelPermalink -}} 2000w
            "
            sizes="100vmin"
            alt="{{- .Params.featured_image.alt -}}">*/}}
        <img class="carousel__image" src="{{- $image2000.RelPermalink -}}" />
    </section>
    {{ end }}
</div>